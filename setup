#!/bin/zsh

DOTFILES_DIR=~/dotfiles
BACKUP_DIR=~/dotfiles_old  # old dotfiles backup directory
NVIM_DIR=~/.config/nvim
ATOM_DIR=~/.atom
ZSHINIT_DIR=~/.zshinit

# list of files/folders to symlink in homedir
files=('.zshrc' '.tmux.conf' '.vimrc' '.atom/keymap.cson' '.config/nvim/init.vim' '.zshinit/nvm_init.sh' '.ignore')

if [ ! -d "$BACKUP_DIR" ]; then
  echo "Creating $BACKUP_DIR for backup of any existing dotfiles"
  mkdir -p $BACKUP_DIR
fi

if [ ! -d "$NVIM_DIR" ]; then
  echo "Creating neovim config directory"
  mkdir -p $NVIM_DIR
fi

if [ ! -d "$ATOM_DIR" ]; then
  echo "Creating atom config directory"
  mkdir -p $ATOM_DIR
fi

if [ ! -d "$ZSHINIT_DIR" ]; then
  echo "Creating zshinit config directory"
  mkdir -p $ZSHINIT_DIR
fi

for file in $files; do
  if [ -e ~/"$file" ] && [ ! -h ~/"$file" ]; then
    echo "Moving existing file $file to backup directory"
    mv ~/$file ~/dotfiles_old/
  fi

  if [ -h ~/"$file" ]; then
    echo "removing existing symlink ~/$file"
    rm ~/"$file"
  fi

  echo "Creating symlink to $DOTFILES_DIR/$file in home directory."
  ln -s $DOTFILES_DIR/$file ~/$file
done
